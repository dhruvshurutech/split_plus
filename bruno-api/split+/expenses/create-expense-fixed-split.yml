info:
  name: create-expense-fixed-split
  type: http
  seq: 3

http:
  method: POST
  url: "{{base_url}}/groups/{{group_id}}/expenses"
  auth: none
  headers:
    - name: Authorization
      value: "Bearer {{access_token}}"
      enabled: true
  body:
    type: json
    data: |-
      {
        "title": "Dinner Reimbursement - Chokhi",
        "notes": "Reimbursement for dinner paid by user",
        "amount": "750.00",
        "date": "2026-01-31",
        "payments": [
          {
            "user_id": "{{user_id}}",
            "amount": "750.00",
            "payment_method": "card"
          }
        ],
        "splits": [
          {
            "user_id": "{{invite_user_id}}",
            "type": "fixed",
            "amount": "750.00"
          }
        ]
      }

settings:
  encodeUrl: true
  timeout: 0
  followRedirects: true
  maxRedirects: 5

docs: |
  # Fixed Split Example

  A fixed split uses pre-determined, specific amounts for each person. The backend validates that the amounts sum to the total.

  ## When to Use
  - Reimbursements (one person paid the full amount)
  - Pre-agreed payment amounts
  - Rent or utilities sharing with specific amounts
  - Cost sharing where amounts were predetermined
  - Unequal splits where one person pays more

  ## Validation Logic (Backend)
  The backend validates that fixed amounts sum to the total:
  - **Total Amount**: $750.00
  - **Payer**: User A
  - **Who Owes**: User B owes the full $750.00
  - **Backend Validates**: $750.00 = $750.00 ✓

  **Example 2: Multiple Fixed Amounts**
  - **Total Amount**: $150.00
  - **Payer**: User A
  - **Who Owes**: User A: $100.00, User B: $50.00
  - **Backend Validates**: $100.00 + $50.00 = $150.00 ✓

  ## Important Notes
  - Set `"type": "fixed"` for each split
  - Provide the `"amount"` field with the exact amount
  - Do NOT provide `percentage` or `shares` fields
  - Split amounts MUST sum to exactly the expense total
  - The backend validates (not calculates) the amounts
  - All split user_ids must be group members
  - At least one split is required
  - All splits must have the same type (no mixing fixed with equal, etc.)

  ## Validation Rules
  - All splits must have type "fixed"
  - Split amounts must sum to exactly the expense amount
  - Cannot mix split types in one expense
  - Each amount must be ≥ 0
  - Each split must reference a valid group member
  - Payment total must equal expense amount

  ## Response
  Returns the created expense with:
  - `expense`: Expense object containing id, title, amount, etc.
  - `splits`: Array of split objects showing:
    - `amount_owned`: The fixed amount you provided
    - `share_value`: null (not applicable for fixed splits)

  ## Status Codes
  - `201 Created`: Expense successfully created with validated splits
  - `422 Unprocessable Entity`: Split amounts don't sum to expense amount
  - `400 Bad Request`: Invalid request data (e.g., missing amount field)
  - `401 Unauthorized`: Missing or invalid access token
  - `403 Forbidden`: User is not a group member

  ## Difference from Equal Split
  While equal splits are calculated automatically by the backend, fixed splits require you to specify each amount explicitly. Use fixed split when you want to explicitly control each amount upfront.

  ## Difference from Custom Split
  Fixed and custom splits work identically - both require explicit amounts. The "custom" type is just semantic metadata to indicate non-standard splits.
